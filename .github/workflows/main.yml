# name: FastAPI CI/CD Pipeline

# on:
#   push:
#     branches: [ "main" ]
#   pull_request:
#     branches: [ "main" ]

# jobs:
#   build:
#     runs-on: ubuntu-latest

#     steps:
#       # Checkout code
#       - name: Checkout repository
#         uses: actions/checkout@v3

#       # Setup Python
#       - name: Set up Python
#         uses: actions/setup-python@v4
#         with:
#           python-version: "3.10"

#       # Install dependencies
#       - name: Install dependencies
#         run: |
#           python -m pip install --upgrade pip
#           if [ -f requirements.txt ]; then pip install -r requirements.txt; fi

#       # Run tests (skip if no tests)
#       - name: Run tests
#         run: |
#           echo "No tests added yet"

#       # Login to GHCR
#       - name: Log in to GitHub Container Registry
#         uses: docker/login-action@v2
#         with:
#           registry: ghcr.io
#           username: ${{ github.actor }}
#           password: ${{ secrets.SECRET_TOKEN }}

#       # # Build Docker image
#       # - name: Build Docker image
#       #   run: |
#       #     docker build -t ghcr.io/${{ github.repository_owner }}/fastapi-app:latest .

#       # # Push Docker image
#       # - name: Push Docker Image
#       #   run: |
#       #     docker push ghcr.io/${{ github.repository_owner }}/fastapi-app:latest



#       # Build Docker image
#       - name: Build Docker image
#         run: |
#              docker build -t 1080171/fastapi-app:latest .

#              # docker build -t ghcr.io/vaishnavigupta-a11y/fastapi-app:latest .

#       # Push Docker image
#       - name: Push Docker Image
#         run: |
#            docker push 1080171/fastapi-app:latest

#            # docker push ghcr.io/vaishnavigupta-a11y/fastapi-app:latest
#       # OPTIONAL: Deploy (e.g., to SSH Server)
#       # - name: Deploy over SSH
#       #   uses: appleboy/ssh-action@v0.1.6
#       #   with:
#       #     host: ${{ secrets.SERVER_IP }}
#       #     username: ${{ secrets.SERVER_USER }}
#       #     key: ${{ secrets.SERVER_SSH_KEY }}
#       #     script: |
#       #       docker pull ghcr.io/${{ github.repository_owner }}/fastapi-app:latest
#       #       docker stop fastapi || true
#       #       docker rm fastapi || true
#       #       docker run -d -p 8000:8000 --name fastapi ghcr.io/${{ github.repository_owner }}/fastapi-app:latest
# name: FastAPI CI/CD Pipeline

# on:
#   push:
#     branches: [ "main" ]
#   pull_request:
#     branches: [ "main" ]

# jobs:
#   build:
#     runs-on: ubuntu-latest

#     steps:
#       # Checkout code
#       - name: Checkout repository
#         uses: actions/checkout@v3

#       # Setup Python
#       - name: Set up Python
#         uses: actions/setup-python@v4
#         with:
#           python-version: "3.10"

#       # Install dependencies
#       - name: Install dependencies
#         run: |
#           python -m pip install --upgrade pip
#           if [ -f requirements.txt ]; then pip install -r requirements.txt; fi

#       # Run tests (skip if no tests)
#       - name: Run tests
#         run: |
#           echo "No tests added yet"

#       # Login to GHCR
#       - name: Log in to GitHub Container Registry
#         uses: docker/login-action@v2
#         with:
#           registry: ghcr.io
#           username: ${{ github.actor }}
#           password: ${{ secrets.SECRET_TOKEN }}

#       # # Build Docker image
#       # - name: Build Docker image
#       #   run: |
#       #     docker build -t ghcr.io/${{ github.repository_owner }}/fastapi-app:latest .

#       # # Push Docker image
#       # - name: Push Docker Image
#       #   run: |
#       #     docker push ghcr.io/${{ github.repository_owner }}/fastapi-app:latest



#       # Build Docker image
#       - name: Build Docker image
#         run: |
#              docker build -t 1080171/fastapi-app:latest .

#              # docker build -t ghcr.io/vaishnavigupta-a11y/fastapi-app:latest .

#       # Push Docker image
#       - name: Push Docker Image
#         run: |
#            docker push 1080171/fastapi-app:latest

#            # docker push ghcr.io/vaishnavigupta-a11y/fastapi-app:latest
#       # OPTIONAL: Deploy (e.g., to SSH Server)
#       # - name: Deploy over SSH
#       #   uses: appleboy/ssh-action@v0.1.6
#       #   with:
#       #     host: ${{ secrets.SERVER_IP }}
#       #     username: ${{ secrets.SERVER_USER }}
#       #     key: ${{ secrets.SERVER_SSH_KEY }}
#       #     script: |
#       #       docker pull ghcr.io/${{ github.repository_owner }}/fastapi-app:latest
#       #       docker stop fastapi || true
#       #       docker rm fastapi || true
#       #       docker run -d -p 8000:8000 --name fastapi ghcr.io/${{ github.repository_owner }}/fastapi-app:latest

# hiiii
name: FastAPI CI/CD Pipeline

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]
# jobs:
#   build:
#   test:
#   deploy:
# job mtlb task mglb github en task ko hi dekehga
# uns-on: ubuntu-latest ka matlab:

# ðŸ‘‰ GitHub tumhare liye ek free computer (server) banata hai
# ðŸ‘‰ Jiska Operating System Ubuntu Linux hota hai (latest version)

# Is computer ke upar hi:

# Python install hota hai

# Docker build hota hai

# Requirements install hoti hain

# Tests run hote hain

# Code check hota hai

# Docker push bhi ho sakta hai

# Deployment scripts bhi chal sakte hain

# âž¡ Tumhari saari CI/CD commands isi free Ubuntu machine par run hoti hain.
jobs:
  build:
    runs-on: ubuntu-latest 
    # GitHub provides you a free Linux server for CI/CD.

    steps: #gitu jo action ubnatu machine me steo by step kreg
      # Checkout code
      - name: Checkout repository #machine joki vritaull bani hai linux os ki usme github projcet dwnnd krta hai jwoi project hjisme hmne changes kre ya pul kra woi prject
        uses: actions/checkout@v3

      # Setup Python
      - name: Set up Python
#       ðŸŸ¦ 3. actions/checkout@v3

# Ye ek ready-made button hai GitHub ke paas.

# Ye button dabate hi:

# ðŸŸ¨ 4. GitHub tumhara poora project download kar deta hai

# Exactly waise hi jaise tum:

# GitHub se project ZIP download karte ho

# ya git clone karte ho
        uses: actions/setup-python@v4
        with:
          python-version: "3.10"

      # Install dependencies 
      - name: Install dependencies #name ka mtln baisvally jo githu actuon me jb ham run krte hai tets jb dukhte hai na step ke nam woi steo ke nam hai
        run: |
          python -m pip install --upgrade pip
          if [ -f requirements.txt ]; then pip install -r requirements.txt; fi 
          run ka mtkb ki jb ye cj dnwnd hojye t kosi commad run ho ubantu sytem me

      # Run tests (skip if no tests)
      - name: Run tests
        run: |
          echo "No tests added yet"

      # Login to GHCR
        # name: Log in to GitHub Container Registry
        # uses: docker/login-action@v2
        # with:
        #   registry: ghcr.io
         #  username: ${{ github.actor }}
          # password: ${{ secrets.SECRET_TOKEN }}

      # # Build Docker image
      # - name: Build Docker image
      #   run: |
      #     docker build -t ghcr.io/${{ github.repository_owner }}/fastapi-app:latest .

      # # Push Docker image
      # - name: Push Docker Image
      #   run: |
      #     docker push ghcr.io/${{ github.repository_owner }}/fastapi-app:latest



      # # Build Docker image
      # - name: Build Docker image
      #   run: |
      #        docker build -t 1080171/fastapi-app:latest .

      #        # docker build -t ghcr.io/vaishnavigupta-a11y/fastapi-app:latest .

      # # Push Docker image
      # - name: Push Docker Image
      #   run: |
      #      docker push 1080171/fastapi-app:latest

      #      # docker push ghcr.io/vaishnavigupta-a11y/fastapi-app:latest
      # # OPTIONAL: Deploy (e.g., to SSH Server)
      # # - name: Deploy over SSH
      # #   uses: appleboy/ssh-action@v0.1.6
      # #   with:
      # #     host: ${{ secrets.SERVER_IP }}
      # #     username: ${{ secrets.SERVER_USER }}
      # #     key: ${{ secrets.SERVER_SSH_KEY }}
      # #     script: |
      # #       docker pull ghcr.io/${{ github.repository_owner }}/fastapi-app:latest
      # #       docker stop fastapi || true
      # #       docker rm fastapi || true
      # #       docker run -d -p 8000:8000 --name fastapi ghcr.io/${{ github.repository_owner }}/fastapi-app:latest
